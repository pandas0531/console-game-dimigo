from pwn import *
from ctypes import *

p = process("./linux_main")

libc = CDLL("/lib/x86_64-linux-gnu/libc.so.6")
libc.srand(libc.time(0x00))

def crack():
    p.recvuntil(b"Your Point : ")
    user_point = int(p.recvline())
    if user_point >= 10000:
        print("Finish")
        quit()
    else:
        print(f"[+] User Point is : {user_point}")
        random_crack = libc.rand()%2
        print(f"[+] Cracked Answer is : {random_crack}")

        p.sendline(str(random_crack))
        p.sendline()

for i in range(5):
    crack()

p.interactive()
